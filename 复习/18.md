以下是对《Lecture 2: Cryptography》的超级详细复习，涵盖核心概念、算法原理及实际应用：

---

### **一、密码学基础概念**
#### 1. **核心术语**
- **明文（Plaintext）**：原始信息 \( M \)。
- **密文（Ciphertext）**：加密后的信息 \( C = E(M) \)。
- **解密（Decryption）**：恢复明文 \( M = D(C) \)。
- **密钥（Key）**：控制加密/解密过程的秘密参数。

#### 2. **密码学目标**
- **机密性**（Confidentiality）：防止未授权访问。
- **完整性**（Integrity）：检测数据篡改。
- **认证**（Authentication）：验证身份。
- **不可否认性**（Non-repudiation）：防止发送方否认行为。

---

### **二、古典密码**
#### 1. **凯撒密码（Caesar Cipher）**
- **原理**：字母表位移（如位移3：A→D, B→E）。
- **公式**：\( C = (M + n) \mod 26 \)，\( M = (C - n) \mod 26 \)。
- **弱点**：仅26种可能密钥，易受暴力破解。

#### 2. **替换密码（Substitution Cipher）**
- **原理**：字母随机映射（如A→X, B→Z）。
- **攻击方法**：频率分析（英语中E出现频率最高）。

#### 3. **ATBASH密码**
- **原理**：字母表逆序映射（A↔Z, B↔Y）。
- **特点**：无需密钥，但安全性极低。

---

### **三、现代密码学**
#### 1. **对称加密（Symmetric Cryptography）**
- **特点**：加密/解密使用同一密钥 \( K \)。
- **算法示例**：
  - **DES**（Data Encryption Standard）：
    - 64位分组，56位密钥。
    - 16轮Feistel网络（替换+置换）。
    - 弱点：密钥过短（\( 2^{56} \) 暴力破解）。
  - **AES**（Advanced Encryption Standard）：
    - 128/192/256位密钥，128位分组。
    - 10/12/14轮SPN结构（SubBytes, ShiftRows, MixColumns, AddRoundKey）。
    - 安全性：\( 2^{128} \) 密钥空间，抗量子攻击。

#### 2. **非对称加密（Public Key Cryptography）**
- **特点**：公钥加密，私钥解密（或反之）。
- **算法示例**：
  - **RSA**：
    - **密钥生成**：
      1. 选大素数 \( p, q \)，计算 \( n = pq \)。
      2. 选 \( e \) 满足 \( \gcd(e, (p-1)(q-1)) = 1 \)。
      3. 计算 \( d = e^{-1} \mod (p-1)(q-1) \)。
    - **加密/解密**：
      - 加密：\( C = M^e \mod n \)。
      - 解密：\( M = C^d \mod n \)。
    - **安全性**：基于大数分解难题。
  - **Diffie-Hellman密钥交换**：
    - 协商共享密钥：\( K = \alpha^{X_A X_B} \mod p \)。
    - 安全性：基于离散对数难题。

#### 3. **哈希函数（Hash Functions）**
- **特性**：
  - 单向性：难以从哈希值 \( H(M) \) 反推 \( M \)。
  - 抗碰撞：难以找到 \( M_1 \neq M_2 \) 使 \( H(M_1) = H(M_2) \)。
- **应用**：
  - 数字签名（如SHA-256 + RSA）。
  - 区块链默克尔树（Merkle Tree）。

---

### **四、密钥管理**
#### 1. **对称加密的密钥分发问题**
- **密钥爆炸**：\( n \) 用户需 \( \frac{n(n-1)}{2} \) 个密钥。
- **解决方案**：使用密钥分发中心（KDC）或非对称加密协商会话密钥。

#### 2. **数字签名**
- **流程**：
  1. Alice用私钥加密哈希值：\( S = E_{priv}(H(M)) \)。
  2. Bob用Alice公钥解密 \( S \)，验证 \( H(M) \) 是否匹配。
- **优势**：不可伪造、不可否认。

---

### **五、实际攻击与防御**
#### 1. **DES的弱点**
- **暴力破解**：56位密钥可在数小时内破解（如DES Crackers）。
- **改进方案**：
  - **3DES**：\( C = E_{K1}(D_{K2}(E_{K1}(P))) \)，抗中间相遇攻击。
  - **AES**：更高效且安全。

#### 2. **RSA的侧信道攻击**
- **计时攻击**：通过计算时间推断私钥。
- **防御**：恒定时间算法、盲签名。

---

### **六、密码学工具组合应用**
| **场景**               | **技术组合**                          |
|------------------------|---------------------------------------|
| 安全通信               | DH密钥交换 + AES加密                  |
| 文件完整性验证         | SHA-256哈希 + 数字签名                |
| 区块链交易验证         | 椭圆曲线签名（ECDSA） + 默克尔树      |

---

### **七、关键公式速查**
1. **RSA密钥生成**：
   \[
   d = e^{-1} \mod (p-1)(q-1)
   \]
2. **Diffie-Hellman共享密钥**：
   \[
   K = \alpha^{X_A X_B} \mod p
   \]
3. **哈希签名验证**：
   \[
   \text{验证} \quad H(M) \stackrel{?}{=} D_{pub}(S)
   \]

---

### **八、复习要点**
1. **古典密码**：理解频率分析及替换密码的弱点。
2. **对称加密**：掌握DES/AES结构及密钥管理问题。
3. **非对称加密**：熟练RSA/DH的数学原理及安全性假设。
4. **实际应用**：结合区块链场景（如比特币使用ECDSA签名）。

通过此复习，可系统掌握密码学核心内容，应对考试或实际开发中的安全需求。
